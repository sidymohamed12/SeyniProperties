<!-- templates/employees/mobile/modals/report_modal.html -->
<div id="report-modal" class="fixed inset-0 bg-black bg-opacity-50 z-50 hidden flex items-center justify-center p-4">
    <div class="bg-white rounded-xl max-w-md w-full max-h-[80vh] overflow-y-auto">
        <div class="p-4 border-b border-gray-200">
            <div class="flex items-center justify-between">
                <h3 class="text-lg font-semibold text-gray-900">Rapport technique</h3>
                <button onclick="closeReportModal()" class="text-gray-400 hover:text-gray-600">
                    <i class="fas fa-times text-xl"></i>
                </button>
            </div>
        </div>
        
        <form id="report-form" class="p-4">
            <!-- Rapport -->
            <div class="mb-4">
                <label class="block text-sm font-medium text-gray-700 mb-2">
                    Travaux effectués <span class="text-red-500">*</span>
                </label>
                
                <!-- Modèles de rapport rapide -->
                <div class="grid grid-cols-1 gap-2 mb-3">
                    <button type="button" onclick="setQuickReport('Intervention réalisée selon les consignes. Problème résolu avec succès.')" 
                            class="bg-green-50 text-green-700 p-2 rounded-lg text-sm border border-green-200 text-left">
                        ✅ Intervention réussie
                    </button>
                    <button type="button" onclick="setQuickReport('Intervention partiellement réalisée. Nécessite une intervention complémentaire.')" 
                            class="bg-yellow-50 text-yellow-700 p-2 rounded-lg text-sm border border-yellow-200 text-left">
                        ⚠️ Intervention partielle
                    </button>
                    <button type="button" onclick="setQuickReport('Intervention reportée. Matériel ou pièces manquantes pour finaliser.')" 
                            class="bg-red-50 text-red-700 p-2 rounded-lg text-sm border border-red-200 text-left">
                        ❌ Intervention reportée
                    </button>
                </div>
                
                <textarea id="report-content" name="commentaire_technicien" rows="4" required
                          class="w-full p-3 border border-gray-300 rounded-lg resize-none"
                          placeholder="Décrivez en détail les travaux effectués, les problèmes rencontrés, les solutions apportées...">{{ intervention.commentaire_technicien }}</textarea>
            </div>
            
            <!-- Coût réel -->
            <div class="mb-4">
                <label class="block text-sm font-medium text-gray-700 mb-2">Coût réel (FCFA)</label>
                <input type="number" id="report-cost" name="cout_reel" 
                       class="w-full p-3 border border-gray-300 rounded-lg"
                       placeholder="Coût final de l'intervention"
                       value="{{ intervention.cout_reel|default:'' }}">
            </div>
            
            <!-- Pièces utilisées -->
            <div class="mb-4">
                <label class="block text-sm font-medium text-gray-700 mb-2">Pièces/Matériaux utilisés</label>
                <div id="parts-list" class="space-y-2">
                    <div class="flex items-center space-x-2">
                        <input type="text" name="parts[]" 
                               class="flex-1 p-2 border border-gray-300 rounded-lg text-sm"
                               placeholder="Ex: Joint d'étanchéité, Vis, etc.">
                        <button type="button" onclick="addPartField()" 
                                class="bg-blue-100 text-blue-600 p-2 rounded-lg">
                            <i class="fas fa-plus"></i>
                        </button>
                    </div>
                </div>
            </div>
            
            <!-- Actions -->
            <div class="space-y-3">
                <button type="submit" 
                        class="w-full bg-green-600 text-white py-3 rounded-lg font-medium">
                    <i class="fas fa-save mr-2"></i>
                    Sauvegarder le rapport
                </button>
                
                <button type="button" onclick="closeReportModal()" 
                        class="w-full bg-white text-gray-600 py-3 rounded-lg font-medium border border-gray-200">
                    Annuler
                </button>
            </div>
        </form>
    </div>
</div>